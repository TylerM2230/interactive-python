<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nested Loops in Python</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../css/shared-styles.css">
  </head>
  <body class="">
    <div class="console-screen-border">
      <nav class="navbar-8bit">
        <a href="../index.html" class="btn">
          &laquo; Main Menu
        </a>
        <a href="string-operations.html" class="btn">
          Next: String Operations &rarr;
        </a>
      </nav>

      <div class="content-wrapper-8bit">
        <header class="text-center mb-8">
          <h1 class="pixel-header"><a href="../index.html">
            Interactive Guide to Python
          </a></h1>
          <h2 class="pixel-subheader">
            Nested Loops
          </h2>
          <p class="text-sm italic mt-1">
            Using loops inside other loops to process multi-dimensional data or generate combinations.
          </p>
        </header>

        <section class="game-section">
          <h2 class="section-title-8bit">
            1. What are Nested Loops?
          </h2>
          <p class="mb-4 text-gray-300">
            Nested loops are like a clock with two hands - the hour hand (outer loop) moves slowly, and for each position of the hour hand, the minute hand (inner loop) makes a complete circle. Just as the minute hand completes its full rotation for each hour, the inner loop completes all its iterations for each single iteration of the outer loop. Think of it like a Russian nesting doll - each doll contains another doll inside, and you need to open each outer doll to access the inner ones.
          </p>
          <p class="mb-2 text-gray-300">
            Think of it like a game of chess: for each move of the white pieces (outer loop), black gets to make all their possible moves (inner loop). The key concept is that for <strong>each single iteration</strong> of the outer loop, the <strong>entire inner loop</strong> completes all of its iterations. It's similar to how a teacher might check each student's homework (outer loop), and for each student, they need to check every question (inner loop).
          </p>
          <pre><code class="language-python"># Basic structure (for loop inside a for loop)
for i in range(3):  # Outer loop (runs 3 times: i=0, i=1, i=2)
  print(f"Outer loop iteration: i = {i}")
  for j in range(2):  # Inner loop (runs 2 times for EACH outer iteration: j=0, j=1)
    print(f"  Inner loop iteration: j = {j}")
  print("-" * 10) # Separator after inner loop finishes

# Output:
# Outer loop iteration: i = 0
#   Inner loop iteration: j = 0
#   Inner loop iteration: j = 1
# ----------
# Outer loop iteration: i = 1
#   Inner loop iteration: j = 0
#   Inner loop iteration: j = 1
# ----------
# Outer loop iteration: i = 2
#   Inner loop iteration: j = 0
#   Inner loop iteration: j = 1
# ----------</code></pre>
          <p class="mt-2 text-gray-300">
            You can nest any type of loop inside another (e.g., a
            <code>while</code> loop inside a <code>for</code> loop), but nested
            <code>for</code> loops are very common.
          </p>
        </section>

        <section class="game-section">
          <h2 class="section-title-8bit">
            2. Common Use Cases
          </h2>
          <p class="mb-2 text-gray-300">
            Nested loops are like having a map of a city - you need to visit each street (outer loop) and then check each house on that street (inner loop). They're powerful for tasks that involve multi-dimensional structures or combinations. Think of it like a treasure hunt where you need to check each room in a house (outer loop), and within each room, you need to look in every possible hiding spot (inner loop).
          </p>
          <ul class="list-disc list-inside mb-4 space-y-2 text-gray-300">
            <li>
              <strong>Working with Grids or 2D Arrays:</strong> Like reading a spreadsheet - you go through each row (outer loop) and then check each column in that row (inner loop). It's similar to how you might read a book - first you pick a page (row), then you read each word on that page (column). Think of it like a farmer plowing a field - they need to plow each row (outer loop), and within each row, they need to plow every inch (inner loop).
            </li>
            <li>
              <strong>Generating Combinations or Pairs:</strong> Like making all possible outfits from your wardrobe - for each shirt (outer loop), you try it with every pair of pants (inner loop). It's like a restaurant menu where each main course can be paired with any side dish. Think of it like a dance competition where each dancer (outer loop) needs to perform with every possible partner (inner loop).
            </li>
            <li>
              <strong>Creating Patterns:</strong> Like building with blocks - you place blocks in rows (outer loop) and then fill each row with the right number of blocks (inner loop). It's similar to how you might color in a grid - first you choose a row, then you color each cell in that row. Think of it like knitting a sweater - you need to knit each row (outer loop), and within each row, you need to make every stitch (inner loop).
            </li>
            <li>
              <strong>Processing Multi-level Data:</strong> Like organizing a library - you go through each bookshelf (outer loop) and then look at each book on that shelf (inner loop). It's like how you might clean a house - first you pick a room, then you clean each item in that room. Think of it like a family tree - you need to check each generation (outer loop), and within each generation, you need to look at every family member (inner loop).
            </li>
          </ul>
          <pre><code class="language-python"># Example: Generating coordinate pairs (like a grid)
rows = 3
cols = 2
coordinates = []

for r in range(rows): # Outer loop for rows
    for c in range(cols): # Inner loop for columns
        coordinates.append((r, c)) # Add the (row, col) tuple

print(coordinates)
# Output: [(0, 0), (0, 1), (1, 0), (1, 1), (2, 0), (2, 1)]</code></pre>
        </section>

        <section class="game-section interactive-section">
          <h2 class="section-title-8bit">
            3. See Nested Loops in Action (Generating Coordinates)
          </h2>
          <p class="mb-4 text-gray-300">
            Let's watch our clock in action! We'll generate coordinate pairs for a small grid, where the hour hand (outer loop) represents rows and the minute hand (inner loop) represents columns. Each time the hour hand moves, the minute hand will make a complete circle, just like how each row will be paired with every possible column. Think of it like a game of Battleship - you need to check each row (outer loop), and within each row, you need to check every column position (inner loop) to find the ships.
          </p>
          <div class="mb-4">
            <button id="runNestedLoopButton" class="btn btn-green">
              Run Nested Loop
            </button>
            <button id="resetNestedLoopButton" class="btn">Reset</button>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <h3 class="text-lg font-medium mb-2 text-cyan-400">Loop State:</h3>
              <div class="bg-blue-900 p-4 rounded-md">
                <p class="text-gray-300">
                  Outer Loop (<code class="font-semibold text-yellow-300">i</code>):
                  <span id="outerLoopCounter" class="loop-counter outer-loop"
                    >-</span
                  >
                </p>
                <p class="text-gray-300">
                  Inner Loop (<code class="font-semibold text-yellow-300">j</code>):
                  <span id="innerLoopCounter" class="loop-counter inner-loop"
                    >-</span
                  >
                </p>
              </div>
              <h4 class="text-md font-medium mt-4 mb-1 text-cyan-400">Code Snippet:</h4>
              <pre class="text-xs bg-blue-900 border-blue-500 text-gray-200"><code class="language-python">
<span class="code-line" data-line="1">for i in range(3): # Outer</span>
<span class="code-line indent-1" data-line="2">  # Outer loop body starts</span>
<span class="code-line indent-1" data-line="3">  for j in range(2): # Inner</span>
<span class="code-line indent-2" data-line="4">    # Inner loop body starts</span>
<span class="code-line indent-2" data-line="5">    print(f"({i}, {j})")</span>
<span class="code-line indent-2" data-line="6">    # Inner loop body ends</span>
<span class="code-line indent-1" data-line="7">  # Inner loop finishes</span>
<span class="code-line indent-1" data-line="8"> # Outer loop body ends</span>
<span class="code-line" data-line="9"># Outer loop finishes</span>
                      </code></pre>
            </div>

            <div>
              <h3 class="text-lg font-medium mb-2 text-cyan-400">Generated Output:</h3>
              <div id="nestedLoopOutput" class="output-display bg-blue-900 border-yellow-500 text-gray-200">
                <span class="text-gray-400 italic"
                  >Click "Run Nested Loop" to start.</span
                >
              </div>
            </div>
          </div>
          <div
            id="nestedLoopMessage"
            class="message-box"
            style="display: none"
          ></div>
        </section>

        <section class="game-section interactive-section">
          <h2 class="section-title-8bit">4. Quick Quiz</h2>
          <p class="mb-4 text-gray-300">Test your understanding!</p>
          <div class="mb-3">
            <p class="font-medium mb-1 text-gray-200">
              Q1: If an outer loop runs 3 times and an inner loop runs 4 times for
              each outer iteration, how many times does the innermost code block
              execute in total?
            </p>
            <label class="block text-gray-300"
              ><input type="radio" name="q1_nestedloop" value="a" class="mr-1" />
              3 times</label
            >
            <label class="block text-gray-300"
              ><input type="radio" name="q1_nestedloop" value="b" class="mr-1" />
              4 times</label
            >
            <label class="block text-gray-300"
              ><input type="radio" name="q1_nestedloop" value="c" class="mr-1" />
              7 times</label
            >
            <label class="block text-gray-300"
              ><input type="radio" name="q1_nestedloop" value="d" class="mr-1" />
              12 times</label
            >
          </div>
          <div class="mb-3">
            <p class="font-medium mb-1 text-gray-200">Q2: Consider the code:</p>
            <pre class="text-xs bg-blue-900 border-blue-500 text-gray-200"><code class="language-python">count = 0
for x in range(2):
  for y in range(2):
    count = count + 1
print(count)</code></pre>
            <p class="font-medium mt-1 text-gray-200">What will be printed?</p>
            <label class="block text-gray-300"
              ><input type="radio" name="q2_nestedloop" value="a" class="mr-1" />
              2</label
            >
            <label class="block text-gray-300"
              ><input type="radio" name="q2_nestedloop" value="b" class="mr-1" />
              3</label
            >
            <label class="block text-gray-300"
              ><input type="radio" name="q2_nestedloop" value="c" class="mr-1" />
              4</label
            >
            <label class="block text-gray-300"
              ><input type="radio" name="q2_nestedloop" value="d" class="mr-1" />
              1</label
            >
          </div>
          <div class="mb-3">
            <p class="font-medium mb-1 text-gray-200">
              Q3: Which use case is NOT a typical application of nested loops?
            </p>
            <label class="block text-gray-300"
              ><input type="radio" name="q3_nestedloop" value="a" class="mr-1" />
              Iterating through a simple list (1D)</label
            >
            <label class="block text-gray-300"
              ><input type="radio" name="q3_nestedloop" value="b" class="mr-1" />
              Processing pixels in an image (grid)</label
            >
            <label class="block text-gray-300"
              ><input type="radio" name="q3_nestedloop" value="c" class="mr-1" />
              Generating all possible pairs of players from two teams</label
            >
          </div>
          <button id="checkQuizButtonNestedLoop" class="btn">
            Check Answers
          </button>
          <div
            id="quizResultNestedLoop"
            class="message-box mt-4"
            style="display: none"
          ></div>
        </section>
      </div>

      <footer class="footer-8bit">
        <p>Happy Coding!</p>
        <p class="mt-2">
          <a
            href="../index.html"
            >Back to Main Menu</a
          >
        </p>
      </footer>
    </div>

    <script src="../js/main.js" defer></script>
    <script>
      // --- Nested Loop Elements and State ---
      const runNestedLoopButton = document.getElementById(
        "runNestedLoopButton"
      );
      const resetNestedLoopButton = document.getElementById(
        "resetNestedLoopButton"
      );
      const outerLoopCounter = document.getElementById("outerLoopCounter");
      const innerLoopCounter = document.getElementById("innerLoopCounter");
      const nestedLoopOutput = document.getElementById("nestedLoopOutput");
      const nestedLoopMessage = document.getElementById("nestedLoopMessage");
      const codeLines = document.querySelectorAll(
        "#nestedCodeDisplay .code-line"
      ); // Select code lines for highlighting

      let nestedLoopInterval = null;
      let currentOuterIndex = 0;
      let currentInnerIndex = 0;
      const outerLimit = 3;
      const innerLimit = 2;
      let nestedLoopRunning = false;

      // --- Quiz Elements ---
      const checkQuizButtonNestedLoop = document.getElementById(
        "checkQuizButtonNestedLoop"
      );
      const quizResultNestedLoop = document.getElementById(
        "quizResultNestedLoop"
      );

      // --- Nested Loop Logic ---
      function highlightCode(lineNumbers) {
        codeLines.forEach((line) => line.classList.remove("highlight")); // Clear previous
        if (Array.isArray(lineNumbers)) {
          lineNumbers.forEach((ln) => {
            const lineElement = document.querySelector(
              `.code-line[data-line="${ln}"]`
            );
            if (lineElement) lineElement.classList.add("highlight");
          });
        } else {
          // Single line number
          const lineElement = document.querySelector(
            `.code-line[data-line="${lineNumbers}"]`
          );
          if (lineElement) lineElement.classList.add("highlight");
        }
      }

      function resetNestedLoop() {
        if (nestedLoopInterval) {
          clearInterval(nestedLoopInterval);
          nestedLoopInterval = null;
        }
        nestedLoopRunning = false;
        currentOuterIndex = 0;
        currentInnerIndex = 0;
        outerLoopCounter.textContent = "-";
        innerLoopCounter.textContent = "-";
        outerLoopCounter.classList.remove("highlight");
        innerLoopCounter.classList.remove("highlight");
        nestedLoopOutput.innerHTML =
          '<span class="text-gray-500 italic">Click "Run Nested Loop" to start.</span>';
        runNestedLoopButton.disabled = false;
        highlightCode([]); // Clear code highlights
        showMessage(nestedLoopMessage, "Nested loop reset.", "info");
      }

      function stepThroughNestedLoop() {
        if (!nestedLoopRunning) return; // Stop if reset called

        // Determine current state and next action
        if (currentOuterIndex < outerLimit) {
          // Outer loop is running
          outerLoopCounter.textContent = currentOuterIndex;
          outerLoopCounter.classList.add("highlight");
          innerLoopCounter.classList.remove("highlight");
          highlightCode([1, 2]); // Highlight outer loop line and start of its body

          // Check if inner loop needs to start/continue
          if (currentInnerIndex < innerLimit) {
            // Inner loop's turn
            innerLoopCounter.textContent = currentInnerIndex;
            outerLoopCounter.classList.remove("highlight"); // De-emphasize outer while inner runs
            innerLoopCounter.classList.add("highlight");
            highlightCode([3, 4, 5, 6]); // Highlight inner loop line and its body

            // Append output for this inner iteration
            nestedLoopOutput.innerHTML += `(${currentOuterIndex}, ${currentInnerIndex})\n`;
            nestedLoopOutput.scrollTop = nestedLoopOutput.scrollHeight; // Auto-scroll

            // Increment inner index for next step
            currentInnerIndex++;
          } else {
            // Inner loop finished for this outer iteration
            innerLoopCounter.textContent = "-"; // Reset inner display
            innerLoopCounter.classList.remove("highlight");
            highlightCode([7, 8]); // Highlight end of inner loop, end of outer body

            // Reset inner index and increment outer index for the *next* step
            currentInnerIndex = 0;
            currentOuterIndex++;
            // Add a separator in output
            if (currentOuterIndex < outerLimit) {
              // Add separator only if outer loop continues
              nestedLoopOutput.innerHTML += `----\n`;
              nestedLoopOutput.scrollTop = nestedLoopOutput.scrollHeight;
            }
          }
        } else {
          // Outer loop finished
          outerLoopCounter.textContent = "-";
          innerLoopCounter.textContent = "-";
          outerLoopCounter.classList.remove("highlight");
          innerLoopCounter.classList.remove("highlight");
          highlightCode([9]); // Highlight end of outer loop

          nestedLoopOutput.innerHTML += `<strong class="text-green-600">Nested loop Complete!</strong>\n`;
          nestedLoopOutput.scrollTop = nestedLoopOutput.scrollHeight;

          clearInterval(nestedLoopInterval);
          nestedLoopInterval = null;
          nestedLoopRunning = false;
          runNestedLoopButton.disabled = false; // Re-enable button
          showMessage(nestedLoopMessage, "Nested loop finished.", "success");
        }
      }

      function startNestedLoop() {
        if (nestedLoopRunning) return; // Prevent multiple runs
        resetNestedLoop(); // Ensure clean state before starting
        nestedLoopRunning = true;
        runNestedLoopButton.disabled = true;
        nestedLoopOutput.innerHTML = "Starting nested loop...\n"; // Clear previous output
        // Initial state setup before first interval tick
        outerLoopCounter.textContent = currentOuterIndex;
        outerLoopCounter.classList.add("highlight");
        innerLoopCounter.textContent = "-"; // Inner hasn't started yet
        highlightCode([1]); // Highlight outer loop start

        nestedLoopInterval = setInterval(stepThroughNestedLoop, 900); // Delay between steps
      }

      // --- Quiz Logic ---
      function checkNestedLoopsQuiz() {
        const answers = {
          q1_nestedloop: "d", // 3 * 4 = 12
          q2_nestedloop: "c", // 2 * 2 = 4 increments
          q3_nestedloop: "a", // Simple list usually needs only one loop
        };
        let score = 0;
        let resultsHTML = "<ul>";
        let allAnswered = true;

        for (const q in answers) {
          const selected = document.querySelector(`input[name="${q}"]:checked`);
          if (!selected) {
            allAnswered = false;
            break;
          }
          const isCorrect = selected.value === answers[q];
          if (isCorrect) {
            score++;
            resultsHTML += `<li class="text-green-700">✓ Question ${q.substring(
              1,
              2
            )}: Correct!</li>`;
          } else {
            resultsHTML += `<li class="text-red-700">✗ Question ${q.substring(
              1,
              2
            )}: Incorrect.</li>`;
          }
        }

        if (!allAnswered) {
          quizResultNestedLoop.textContent =
            "Please answer all questions before checking.";
          quizResultNestedLoop.className = "message-box message-box-error";
          quizResultNestedLoop.style.display = "block";
          return;
        }

        resultsHTML += "</ul>";
        resultsHTML =
          `<p class="font-medium mb-2">You scored ${score} out of ${
            Object.keys(answers).length
          }.</p>` + resultsHTML;

        quizResultNestedLoop.innerHTML = resultsHTML;
        quizResultNestedLoop.className =
          score === Object.keys(answers).length
            ? "message-box message-box-success"
            : "message-box message-box-error";
        quizResultNestedLoop.style.display = "block";
      }

      // --- Event Listeners ---
      runNestedLoopButton.addEventListener("click", startNestedLoop);
      resetNestedLoopButton.addEventListener("click", resetNestedLoop);
      checkQuizButtonNestedLoop.addEventListener("click", checkNestedLoopsQuiz);

      // --- Initial Setup ---
      window.onload = () => {
        resetNestedLoop(); // Set initial state for display
      };
    </script>
  </body>
</html>
