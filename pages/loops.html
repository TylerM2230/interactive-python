<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Learn Loops (For & While)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../css/shared-styles.css">
  </head>
  <body class="bg-blue-700 text-gray-300 p-4 md:p-8">
    <header class="text-center mb-8">
      <a href="../index.html" class="text-3xl md:text-4xl font-bold text-yellow-300 hover:text-yellow-200 transition-colors duration-200">
        Interactive Guide to Python
      </a>
      <h1 class="text-2xl md:text-3xl font-semibold text-yellow-400 mt-2">
        Understanding Loops: For & While
      </h1>
      <p class="text-xs text-cyan-500 mt-1 italic">
        Repeating blocks of code efficiently using 'for' loops for definite iteration and 'while' loops for indefinite iteration.
      </p>
    </header>

    <nav
      class="max-w-4xl mx-auto mb-6 p-3 bg-blue-800 rounded-lg shadow-md flex justify-between items-center"
    >
      <a
        href="nested-conditionals.html"
        class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded transition-colors duration-200"
      >
        &larr; Previous: Nested Conditionals
      </a>
      <a
        href="lists-iteration.html"
        class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded transition-colors duration-200"
      >
        Next: Lists & Iteration &rarr;
      </a>
    </nav>

    <main class="max-w-4xl mx-auto">
      <section class="mb-8">
        <h2 class="text-2xl font-semibold text-yellow-300 mb-3">
          1. Why Use Loops?
        </h2>
        <p class="mb-4">
          Loops are a fundamental concept in programming used to execute a block
          of code repeatedly. Instead of writing the same (or similar) code
          lines multiple times, you can use a loop to automate the repetition.
          This makes your code shorter, easier to read, and less prone to
          errors.
        </p>
        <p>There are two main types of loops in Python:</p>
        <ul class="list-disc list-inside ml-4 mt-2">
          <li>
            <strong><code>for</code> loops:</strong> Used when you want to
            iterate over a sequence of items (like a list, a string, or a range
            of numbers) a specific number of times.
          </li>
          <li>
            <strong><code>while</code> loops:</strong> Used when you want to
            repeat a block of code as long as a certain condition remains true.
          </li>
        </ul>
      </section>

      <section class="mb-8">
        <h2 class="text-2xl font-semibold text-yellow-300 mb-3">
          2. The `for` Loop
        </h2>
        <p class="mb-2">
          A <code>for</code> loop iterates over the items of any sequence (a
          list, a tuple, a dictionary, a set, or a string) or other iterable
          object, executing the block of code once for each item.
        </p>
        <h3 class="text-lg font-medium text-cyan-400 mb-1">
          Iterating over a List:
        </h3>
        <pre><code class="language-python">fruits = ["apple", "banana", "cherry"]
for fruit in fruits:
  print(f"Current fruit: {fruit}")

# Output:
# Current fruit: apple
# Current fruit: banana
# Current fruit: cherry</code></pre>
        <h3 class="text-lg font-medium text-cyan-400 mb-1 mt-3">
          Iterating using `range()`:
        </h3>
        <p class="mb-2">
          The <code>range()</code> function generates a sequence of numbers,
          which is often used with <code>for</code> loops to repeat code a
          specific number of times.
        </p>
        <pre><code class="language-python"># range(5) generates numbers from 0 up to (but not including) 5
for i in range(5):
  print(f"Number: {i}")

# Output:
# Number: 0
# Number: 1
# Number: 2
# Number: 3
# Number: 4</code></pre>
      </section>

      <section class="mb-8 interactive-section">
        <h2 class="text-2xl font-semibold text-yellow-300 mb-3">
          3. See a `for` Loop in Action
        </h2>
        <p class="mb-4">
          Click the button to visualize a <code>for</code> loop iterating
          through a predefined list of items.
        </p>
        <div class="mb-4">
          <button id="runForLoopButton" class="btn btn-green">
            Run `for` Loop
          </button>
          <button id="resetForLoopButton" class="btn">Reset</button>
        </div>
        <h3 class="text-lg font-medium text-cyan-400 mb-2">Sequence (List):</h3>
        <div
          id="forLoopSequence"
          class="bg-blue-900 p-4 rounded-md min-h-[50px] flex flex-wrap items-center"
        ></div>
        <h3 class="text-lg font-medium text-cyan-400 mt-4 mb-2">
          Loop Output / Current Item:
        </h3>
        <div id="forLoopOutput" class="output-display">
          <span class="text-gray-500 italic"
            >Click "Run `for` Loop" to start.</span
          >
        </div>
        <div
          id="forLoopMessage"
          class="message-box"
          style="display: none"
        ></div>
      </section>

      <section class="mb-8">
        <h2 class="text-2xl font-semibold text-yellow-300 mb-3">
          4. The `while` Loop
        </h2>
        <p class="mb-2">
          A <code>while</code> loop executes a block of code as long as a
          specified condition is true. It's used when you don't know beforehand
          how many times you need to loop.
        </p>
        <h3 class="text-lg font-medium text-cyan-400 mb-1">Basic Example:</h3>
        <pre><code class="language-python">count = 0
while count < 5:
  print(f"Count is: {count}")
  count = count + 1  # IMPORTANT: Update the counter

print("Loop finished!")

# Output:
# Count is: 0
# Count is: 1
# Count is: 2
# Count is: 3
# Count is: 4
# Loop finished!</code></pre>
        <h3 class="text-lg font-medium text-cyan-400 mb-1 mt-3">
          Using `break` in a `while` loop:
        </h3>
        <p class="mb-2">
          <strong>Crucially:</strong> The condition must eventually become
          <code>False</code>, or the loop will run forever (an "infinite loop").
          You usually need to include code inside the loop that modifies the
          variables involved in the condition.
        </p>
        <pre><code class="language-python">count = 0  # Initialize a counter

while count < 5:  # Condition: loop as long as count is less than 5
  print(f"Count is: {count}")
  count = count + 1  # IMPORTANT: Update the counter

print("Loop finished!")

# Output:
# Count is: 0
# Count is: 1
# Count is: 2
# Count is: 3
# Count is: 4
# Loop finished!</code></pre>
        <p class="mt-2 text-sm text-red-600 font-medium">
          Warning: Be careful with <code>while</code> loops! Always ensure the
          condition will eventually become false.
        </p>
      </section>

      <section class="mb-8 interactive-section">
        <h2 class="text-2xl font-semibold text-yellow-300 mb-3">
          5. See a `while` Loop in Action
        </h2>
        <p class="mb-4">
          Click the button to visualize a <code>while</code> loop counting up
          until a condition (<code>count &lt; 5</code>) is met.
        </p>
        <div class="mb-4">
          <button id="runWhileLoopButton" class="btn btn-green">
            Run `while` Loop
          </button>
          <button id="resetWhileLoopButton" class="btn">Reset</button>
        </div>
        <h3 class="text-lg font-medium text-cyan-400 mb-2">
          Condition: <code class="text-cyan-400">count < <span id="whileConditionLimit">5</span></code>
        </h3>
        <div class="mb-4">
          <label for="whileLoopLimit" class="mr-2 text-gray-300"
            >Set loop limit (1-10):</label
          >
          <input
            type="number"
            id="whileLoopLimit"
            value="5"
            min="1"
            max="10"
            class="input-field w-20"
          />
        </div>
        <h3 class="text-lg font-medium text-cyan-400 mt-4 mb-2">
          Loop Output / Current Count:
        </h3>
        <div id="whileLoopOutput" class="output-display">
          <span class="text-gray-500 italic"
            >Click "Run `while` Loop" to start.</span
          >
        </div>
        <div
          id="whileLoopMessage"
          class="message-box"
          style="display: none"
        ></div>
      </section>

      <section class="mb-8">
        <h2 class="text-2xl font-semibold text-yellow-300 mb-3">
          6. `break` and `continue` Statements
        </h2>
        <p class="mb-2">
          Python provides two statements to control loop execution:
          <code>break</code> and <code>continue</code>.
        </p>
        <h3 class="text-lg font-medium text-cyan-400 mb-1">
          <code>break</code> Statement:
        </h3>
        <p class="mb-2">
          The <code>break</code> statement immediately exits the current
          loop (the innermost loop if nested).
        </p>
        <pre><code class="language-python"># Example using break
print("--- Break Example ---")
for i in range(10):
  if i == 5:
    print("Breaking loop at i=5")
    break  # Exit the loop
  print(f"i = {i}")

# Output:
# i = 0
# i = 1
# i = 2
# i = 3
# i = 4
# Breaking loop at i=5</code></pre>
        <h3 class="text-lg font-medium text-cyan-400 mb-1 mt-3">
          <code>continue</code> Statement:
        </h3>
        <p class="mb-2">
          The <code>continue</code> statement skips the rest of the code
          inside the current iteration of the loop and proceeds to the next
          iteration.
        </p>
        <pre><code class="language-python"># Example using continue
print("\n--- Continue Example ---")
for i in range(5):
  if i == 2:
    print("Skipping iteration at i=2")
    continue # Skip print(f"i = {i}") for this iteration
  print(f"i = {i}")

# Output:
# i = 0
# i = 1
# Skipping iteration at i=2
# i = 3
# i = 4</code></pre>
        <div class="interactive-section mt-6">
          <h3 class="text-xl font-semibold text-yellow-300 mb-2">
            Test <code>break</code> and <code>continue</code>
          </h3>
          <p class="mb-2">
            Enter a list of numbers separated by commas (e.g., 1,2,3,4,5).
          </p>
          <p class="mb-2">
            The loop will <code>break</code> if it finds a number greater than
            <code class="text-cyan-400">7</code>.
          </p>
          <p class="mb-4">
            It will <code>continue</code> (skip printing) for even numbers.
          </p>
          <input
            type="text"
            id="breakContinueInput"
            placeholder="e.g., 1,2,3,8,4,5"
            class="input-field w-full md:w-1/2"
          />
          <button id="runBreakContinueButton" class="btn btn-green mt-2">
            Run with Break/Continue
          </button>
          <div id="breakContinueOutput" class="output-display mt-4">
            <span class="text-gray-500 italic"
              >Enter numbers and click run.</span
            >
          </div>
        </div>
      </section>

      <section class="mb-8">
        <h2 class="text-2xl font-semibold text-yellow-300 mb-3">
          7. `else` in Loops
        </h2>
        <p class="mb-2">
          Python allows an optional <code>else</code> clause at the end of a
          <code>for</code> or <code>while</code> loop. This block is executed
          if the loop completes normally (i.e., not terminated by a
          <code>break</code> statement).
        </p>
        <h3 class="text-lg font-medium text-cyan-400 mb-1">
          <code>for...else</code>:
        </h3>
        <pre><code class="language-python">for i in range(3):
  print(i)
else:
  print("Loop finished normally.")

# Output:
# 0
# 1
# 2
# Loop finished normally.</code></pre>

        <pre><code class="language-python">for i in range(5):
  print(i)
  if i == 2:
    print("Breaking loop")
    break
else:
  print("Loop finished normally.") # This will NOT be printed

# Output:
# 0
# 1
# 2
# Breaking loop</code></pre>

        <h3 class="text-lg font-medium text-cyan-400 mb-1 mt-3">
          <code>while...else</code>:
        </h3>
        <pre><code class="language-python">count = 0
while count < 3:
  print(count)
  count += 1
else:
  print("Loop finished normally.")

# Output:
# 0
# 1
# 2
# Loop finished normally.</code></pre>
      </section>

      <section class="mb-8">
        <h2 class="text-2xl font-semibold text-yellow-300 mb-3">
          8. Summary & Best Practices
        </h2>
        <ul class="list-disc list-inside ml-4 space-y-2">
          <li>
            <strong><code>for</code> loops:</strong> Use when you know in
            advance how many times you want to repeat.
          </li>
          <li>
            <strong><code>while</code> loops:</strong> Use when you don't know
            beforehand how many times you need to loop.
          </li>
          <li>
            <strong>Be careful with <code>while</code> loops:</strong> Ensure
            the condition will eventually become false to avoid infinite loops.
          </li>
          <li>
            <strong>Use <code>break</code> and <code>continue</code>:</strong>
            Control loop execution more precisely.
          </li>
          <li>
            <strong>Consider <code>else</code> clauses:</strong> Execute code
            after the loop completes normally.
          </li>
        </ul>
      </section>
    </main>

    <footer class="text-center mt-12 py-6 border-t border-yellow-500">
      <p class="text-sm text-cyan-300">Happy Coding!</p>
      <p class="mt-2">
        <a
          href="../index.html"
          class="text-yellow-400 hover:text-yellow-200 font-medium transition-colors duration-200"
          >Back to Main Menu</a
        >
      </p>
    </footer>

    <script src="../js/main.js" defer></script>
    <script>
      // showMessage is now in js/main.js

      // Declare variables that will hold element references
      let runForLoopButton, resetForLoopButton, forLoopSequence, forLoopOutput, forLoopMessage;
      let runWhileLoopButton, resetWhileLoopButton, whileLoopOutput, whileLoopMessage;
      let whileLoopLimitInput, whileConditionLimitSpan;
      let breakContinueInput, runBreakContinueButton, breakContinueOutput;


      const forLoopItems = ["A", "B", "C", "D", "E"];
      let forLoopInterval = null;
      let currentForIndex = 0;

      let currentWhileCount = 0;
      const MAX_WHILE_ITERATIONS = 100; // Safety break
      let whileLoopInterval = null;


      // --- For Loop Logic ---
      function renderForSequence() {
        if (!forLoopSequence) {
          console.error("renderForSequence: forLoopSequence element not found!");
          return;
        }
        forLoopSequence.innerHTML = ""; // Clear previous
        forLoopItems.forEach((item, index) => {
          const span = document.createElement("span");
          span.textContent = item;
          span.className = "loop-item";
          span.dataset.index = index;
          forLoopSequence.appendChild(span);
        });
      }

      function resetForLoop() {
        if (forLoopInterval) {
          clearInterval(forLoopInterval);
          forLoopInterval = null;
        }
        currentForIndex = 0;
        forLoopOutput.innerHTML =
          '<span class="text-gray-500 italic">Click "Run `for` Loop" to start.</span>';
        // Remove highlights
        forLoopSequence
          .querySelectorAll(".loop-item.highlight")
          .forEach((el) => el.classList.remove("highlight"));
        runForLoopButton.disabled = false;
        showMessage(forLoopMessage, "For loop reset.", "info");
      }

      function stepThroughForLoop() {
        // Remove highlight from previous item
        if (currentForIndex > 0) {
          const prevElement = forLoopSequence.querySelector(
            `[data-index="${currentForIndex - 1}"]`
          );
          if (prevElement) prevElement.classList.remove("highlight");
        }

        if (currentForIndex < forLoopItems.length) {
          const currentItem = forLoopItems[currentForIndex];
          const currentElement = forLoopSequence.querySelector(
            `[data-index="${currentForIndex}"]`
          );

          // Highlight current item
          if (currentElement) currentElement.classList.add("highlight");

          // Update output
          forLoopOutput.innerHTML += `Processing item: <strong class="text-blue-600">${currentItem}</strong>\n`;
          currentForIndex++;
        } else {
          // Iteration finished
          forLoopOutput.innerHTML += `<strong class="text-green-600">For loop Complete!</strong>\n`;
          clearInterval(forLoopInterval);
          forLoopInterval = null;
          runForLoopButton.disabled = false; // Re-enable button
          showMessage(forLoopMessage, "For loop finished.", "success");
        }
      }

      function startForLoop() {
        if (forLoopInterval) return; // Prevent multiple runs
        resetForLoop(); // Ensure clean state
        runForLoopButton.disabled = true;
        forLoopOutput.innerHTML = "Starting `for` loop...\n"; // Clear previous output
        forLoopInterval = setInterval(stepThroughForLoop, 800); // Delay between steps
      }

      // --- While Loop Logic ---
      function resetWhileLoop() {
        if (whileLoopInterval) {
          clearInterval(whileLoopInterval);
          whileLoopInterval = null;
        }
        currentWhileCount = 0;
        whileLoopOutput.innerHTML =
          '<span class="text-gray-500 italic">Click "Run `while` Loop" to start.</span>';
        if (runWhileLoopButton) runWhileLoopButton.disabled = false;
        if (showMessage && whileLoopMessage) showMessage(whileLoopMessage, "While loop reset.", "info");
      }

      function stepThroughWhileLoop() {
        if (!whileLoopLimitInput) return; // Guard
        const currentLimit = parseInt(whileLoopLimitInput.value) || 5;

        // Check condition BEFORE executing the block
        const conditionMet = currentWhileCount < currentLimit;
        let statusMessage = `Checking condition: ${currentWhileCount} < ${currentLimit} => ${conditionMet}\n`;

        if (conditionMet) {
          // Simulate loop body execution
          statusMessage += `Condition TRUE. Executing block...\n`;
          statusMessage += `  Output: Count is: <strong class="text-blue-600">${currentWhileCount}</strong>\n`;

          // Simulate counter update
          currentWhileCount++;
          statusMessage += `  Updating counter: count = ${currentWhileCount}\n`;

          // Safety break
          if (currentWhileCount > MAX_WHILE_ITERATIONS) {
            statusMessage += `<strong class="text-red-600">SAFETY BREAK: Exceeded max iterations!</strong>\n`;
            clearInterval(whileLoopInterval);
            whileLoopInterval = null;
            runWhileLoopButton.disabled = false;
            showMessage(
              whileLoopMessage,
              "While loop stopped (safety break).",
              "error"
            );
          }
        } else {
          // Condition is false, loop terminates
          statusMessage += `Condition FALSE. Loop terminates.\n`;
          statusMessage += `<strong class="text-green-600">While loop Complete!</strong>\n`;
          clearInterval(whileLoopInterval);
          whileLoopInterval = null;
          runWhileLoopButton.disabled = false; // Re-enable button
          showMessage(whileLoopMessage, "While loop finished.", "success");
        }
        if (whileLoopOutput) { // Guard
            whileLoopOutput.innerHTML += statusMessage + "----\n";
            // Auto-scroll output
            whileLoopOutput.scrollTop = whileLoopOutput.scrollHeight;
        }
      }

      function startWhileLoop() {
        if (whileLoopInterval) return; // Prevent multiple runs
        resetWhileLoop(); // Ensure clean state
        runWhileLoopButton.disabled = true;
        whileLoopOutput.innerHTML = "Starting `while` loop...\n----\n"; // Clear previous output
        whileLoopInterval = setInterval(stepThroughWhileLoop, 1000); // Delay between steps
      }

      // --- Quiz Logic ---

      // --- Event Listeners ---
      document.addEventListener("DOMContentLoaded", () => {
        // --- Initialize Element References ---
        runForLoopButton = document.getElementById("runForLoopButton");
        resetForLoopButton = document.getElementById("resetForLoopButton");
        forLoopSequence = document.getElementById("forLoopSequence");
        forLoopOutput = document.getElementById("forLoopOutput");
        forLoopMessage = document.getElementById("forLoopMessage");

        runWhileLoopButton = document.getElementById("runWhileLoopButton");
        resetWhileLoopButton = document.getElementById("resetWhileLoopButton");
        whileLoopOutput = document.getElementById("whileLoopOutput");
        whileLoopMessage = document.getElementById("whileLoopMessage");
        whileLoopLimitInput = document.getElementById("whileLoopLimit");
        whileConditionLimitSpan = document.getElementById("whileConditionLimit");

        breakContinueInput = document.getElementById("breakContinueInput");
        runBreakContinueButton = document.getElementById("runBreakContinueButton");
        breakContinueOutput = document.getElementById("breakContinueOutput");

        // --- Attach Event Listeners ---
        if (runForLoopButton) runForLoopButton.addEventListener("click", startForLoop);
        if (resetForLoopButton) resetForLoopButton.addEventListener("click", resetForLoop);

        if (runWhileLoopButton) runWhileLoopButton.addEventListener("click", startWhileLoop);
        if (resetWhileLoopButton) resetWhileLoopButton.addEventListener("click", resetWhileLoop);
        if (whileLoopLimitInput) whileLoopLimitInput.addEventListener("input", updateWhileLoopLimitDisplay);

        if (runBreakContinueButton) runBreakContinueButton.addEventListener("click", runBreakContinueDemo);

        // --- Initial Function Calls ---
        if (forLoopSequence) {
            renderForSequence(); // Display the for loop items initially
        } else {
            console.error("Initial setup: forLoopSequence element not found, cannot render.");
        }
        if (whileLoopLimitInput && whileConditionLimitSpan) {
             updateWhileLoopLimitDisplay(); // Update the displayed limit for while loop
        } else {
            console.error("Initial setup: whileLoopLimitInput or whileConditionLimitSpan not found.");
        }

      });

      // Helper function for break/continue demo (if you add one)
      function runBreakContinueDemo() {
        if (!breakContinueInput || !breakContinueOutput) return;
        const inputText = breakContinueInput.value;
        const numbers = inputText.split(',').map(n => parseInt(n.trim())).filter(n => !isNaN(n));
        let outputHTML = "";

        for (let num of numbers) {
            if (num > 7) {
                outputHTML += `Found ${num}, breaking loop.\\n`;
                break;
            }
            if (num % 2 === 0) {
                outputHTML += `Skipping even number: ${num}\\n`;
                continue;
            }
            outputHTML += `Processing odd number: ${num}\\n`;
        }
        breakContinueOutput.textContent = outputHTML || "No valid numbers processed or loop did not run.";
      }

      // Helper function for while loop limit display
      function updateWhileLoopLimitDisplay() {
        if (whileLoopLimitInput && whileConditionLimitSpan) {
            whileConditionLimitSpan.textContent = whileLoopLimitInput.value;
        }
      }

    </script>
  </body>
</html>
