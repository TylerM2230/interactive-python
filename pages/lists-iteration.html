<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Learn Lists & Iteration</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../css/shared-styles.css">
  </head>
  <body class="bg-blue-700 text-gray-300 p-4 md:p-8">
    <header class="text-center mb-8">
      <a href="../index.html" class="text-3xl md:text-4xl font-bold text-yellow-300 hover:text-yellow-200 transition-colors duration-200">
        Interactive Guide to Python
      </a>
      <h1 class="text-2xl md:text-3xl font-semibold text-yellow-400 mt-2">
        Understanding Lists and Iteration
      </h1>
      <p class="text-xs text-cyan-500 mt-1 italic">
        How to store ordered collections of items and process them one by one.
      </p>
    </header>

    <nav
      class="max-w-4xl mx-auto mb-6 p-3 bg-blue-800 rounded-lg shadow-md flex justify-between items-center"
    >
      <a
        href="loops.html"
        class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded transition-colors duration-200"
      >
        &larr; Previous: Loops (For & While)
      </a>
      <a
        href="nested-loops.html"
        class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded transition-colors duration-200"
      >
        Next: Nested Loops &rarr;
      </a>
    </nav>

    <main class="max-w-4xl mx-auto">
      <section class="mb-8">
        <h2 class="text-2xl font-semibold text-yellow-300 mb-3">
          1. Python Lists: Ordered and Mutable
        </h2>
        <p class="mb-4">
          A list is a fundamental data structure used to store an ordered
          collection of items. Think of it like a shopping list or a to-do list
          where each item has a specific position. Lists are very flexible: they
          can hold items of different types (numbers, strings, even other
          lists!), and you can change their contents (add, remove, or modify
          items).
        </p>
        <p class="mb-2">
          In Python, lists are created using square brackets <code>[]</code>,
          with items separated by commas:
        </p>
        <pre><code class="language-python"># An empty list
empty_list = []

# A list of numbers
numbers = [1, 2, 3, 4, 5]

# A list of strings (text)
fruits = ["apple", "banana", "cherry"]

# A list with mixed data types
mixed_list = [10, "hello", 3.14, True]</code></pre>
      </section>

      <section class="mb-8 interactive-section">
        <h2 class="text-2xl font-semibold text-yellow-300 mb-3">
          2. Accessing Elements: Indexing
        </h2>
        <p class="mb-2">
          Since lists are ordered, each item has a specific position, called its
          **index**. You can access individual items in a list using their index
          inside square brackets <code>[]</code>.
        </p>
        <p class="mb-2 font-medium text-red-600">
          Important: Indexing starts from 0! The first item is at index 0, the
          second at index 1, and so on.
        </p>
        <p class="mb-2">You can also use negative indices:</p>
        <ul class="list-disc list-inside ml-4 space-y-1 text-sm">
          <li><code>-1</code> refers to the last item.</li>
          <li><code>-2</code> refers to the second-to-last item, etc.</li>
        </ul>
        <pre><code class="language-python">my_list = ["apple", "banana", "cherry", "date"]

# Accessing items
first_item = my_list[0]  # Gets "apple"
second_item = my_list[1] # Gets "banana"
last_item = my_list[-1] # Gets "date"
second_last = my_list[-2] # Gets "cherry"

print(f"Index 0: {first_item}")
print(f"Index -1: {last_item}")</code></pre>

        <h3 class="text-lg font-medium mt-4 mb-2">Try Indexing:</h3>
        <p class="text-sm mb-2">
          Use the list below. Enter an index (e.g., 0, 1, -1, -2) to access its
          element.
        </p>
        <div
          id="indexingListVisualizer"
          class="bg-gray-100 p-4 rounded-md min-h-[60px] flex flex-wrap items-center mb-4 relative pb-6"
        ></div>
        <div class="flex flex-wrap items-center">
          <label for="indexInput" class="mr-2">Index:</label>
          <input
            type="number"
            id="indexInput"
            class="input-field input-field-small"
            placeholder="e.g., 0, -1"
          />
          <button id="accessIndexButton" class="btn">Access Element</button>
        </div>
        <h4 class="text-md font-medium mt-3 mb-1">Result:</h4>
        <div id="indexingResultDisplay" class="output-display">
          <span class="text-gray-500 italic"
            >Enter an index and click 'Access Element'.</span
          >
        </div>
        <div
          id="indexingMessage"
          class="message-box"
          style="display: none"
        ></div>
      </section>

      <section class="mb-8 interactive-section">
        <h2 class="text-2xl font-semibold text-yellow-300 mb-3">
          3. Playing with Lists (Operations)
        </h2>
        <p class="mb-4">
          Let's interact with a list. You can add items, remove the last item,
          and see how the list changes.
        </p>
        <div class="mb-4">
          <label for="itemInput" class="mr-2 font-medium">Item to add:</label>
          <input
            type="text"
            id="itemInput"
            class="input-field"
            placeholder="e.g., orange"
          />
          <button id="addButton" class="btn">Add Item</button>
          <button id="removeButton" class="btn btn-secondary">
            Remove Last Item
          </button>
          <button id="clearButton" class="btn btn-secondary">Clear List</button>
        </div>
        <h3 class="text-lg font-medium mb-2">Your List:</h3>
        <div
          id="listVisualizer"
          class="bg-gray-100 p-4 rounded-md min-h-[50px] flex flex-wrap items-center"
        >
          <span class="text-gray-500 italic">List is currently empty.</span>
        </div>
        <div id="listMessage" class="message-box" style="display: none"></div>
        <p class="mt-4 text-sm text-gray-600">
          <strong>Common Operations:</strong><br />
          - <strong>Adding Items:</strong> Use <code>.append()</code> to add to
          the end. <code>my_list.append("new item")</code><br />
          - <strong>Removing Items:</strong> Use <code>.pop()</code> to remove
          the last item, or <code>.remove("item_value")</code> to remove a
          specific value.<br />
          - <strong>Finding Length:</strong> Use <code>len(my_list)</code> to
          get the number of items.
        </p>
      </section>

      <section class="mb-8">
        <h2 class="text-2xl font-semibold text-yellow-300 mb-3">
          4. What is Iteration?
        </h2>
        <p class="mb-4">
          Iteration means repeating a process or a set of steps multiple times.
          When working with lists, we often need to perform an action on each
          item in the list. For example, printing each fruit name, calculating
          the total of numbers, or checking each task on a to-do list.
        </p>
        <p class="mb-2">
          The most common way to iterate through a list in Python is using a
          <code>for</code> loop:
        </p>
        <pre><code class="language-python">fruits = ["apple", "banana", "cherry"]

# This loop goes through each item in the 'fruits' list
# In each repetition, the current item is assigned to the variable 'fruit'
for fruit in fruits:
  # This action is performed for each item
  print(f"Current fruit: {fruit}")

# Expected Output:
# Current fruit: apple
# Current fruit: banana
# Current fruit: cherry</code></pre>
        <p>
          The loop automatically handles going from one item to the next until
          it reaches the end of the list.
        </p>
      </section>

      <section class="mb-8 interactive-section">
        <h2 class="text-2xl font-semibold text-yellow-300 mb-3">
          5. See Iteration in Action
        </h2>
        <p class="mb-4">
          Let's use the list from Section 3 (or a default list if yours is
          empty) and iterate through it. Click the button to see the loop
          process.
        </p>
        <div class="mb-4">
          <button id="iterateButton" class="btn btn-green">
            Iterate Through List
          </button>
          <button id="resetIterationButton" class="btn">Reset Iteration</button>
        </div>
        <h3 class="text-lg font-medium mb-2">List for Iteration:</h3>
        <div
          id="iterationListVisualizer"
          class="bg-gray-100 p-4 rounded-md min-h-[50px] flex flex-wrap items-center"
        >
          <span class="text-gray-500 italic">List will appear here.</span>
        </div>
        <h3 class="text-lg font-medium mt-4 mb-2">
          Iteration Output / Current Step:
        </h3>
        <div id="iterationOutput" class="output-display">
          <span class="text-gray-500 italic"
            >Click "Iterate Through List" to start.</span
          >
        </div>
        <div
          id="iterationMessage"
          class="message-box"
          style="display: none"
        ></div>
      </section>

      <section class="mb-8 interactive-section">
        <h2 class="text-2xl font-semibold text-yellow-300 mb-3">6. Quick Quiz</h2>
        <p class="mb-4">Test your understanding!</p>
        <div class="mb-3">
          <p class="font-medium mb-1">
            Q1: In Python, what is the index of the *first* element in a list?
          </p>
          <label class="block"
            ><input type="radio" name="q1" value="a" class="mr-1" /> 1</label
          >
          <label class="block"
            ><input type="radio" name="q1" value="b" class="mr-1" /> 0</label
          >
          <label class="block"
            ><input type="radio" name="q1" value="c" class="mr-1" /> -1</label
          >
        </div>
        <div class="mb-3">
          <p class="font-medium mb-1">
            Q2: If <code>my_list = [10, 20, 30, 40]</code>, what is
            <code>my_list[-1]</code>?
          </p>
          <label class="block"
            ><input type="radio" name="q2" value="a" class="mr-1" /> 10</label
          >
          <label class="block"
            ><input type="radio" name="q2" value="b" class="mr-1" /> 30</label
          >
          <label class="block"
            ><input type="radio" name="q2" value="c" class="mr-1" /> 40</label
          >
        </div>
        <div class="mb-3">
          <p class="font-medium mb-1">
            Q3: What keyword is typically used to iterate through each item in a
            list?
          </p>
          <label class="block"
            ><input type="radio" name="q3" value="a" class="mr-1" />
            <code>while</code></label
          >
          <label class="block"
            ><input type="radio" name="q3" value="b" class="mr-1" />
            <code>if</code></label
          >
          <label class="block"
            ><input type="radio" name="q3" value="c" class="mr-1" />
            <code>for</code></label
          >
        </div>
        <button id="checkQuizButton" class="btn">Check Answers</button>
        <div
          id="quizResult"
          class="message-box mt-4"
          style="display: none"
        ></div>
      </section>
    </main>

    <footer class="text-center mt-12 py-6 border-t border-yellow-500">
      <p class="text-sm text-cyan-300">Happy Coding!</p>
      <p class="mt-2">
        <a
          href="../index.html"
          class="text-yellow-400 hover:text-yellow-200 font-medium transition-colors duration-200"
          >Back to Main Menu</a
        >
      </p>
    </footer>

    <script src="../js/main.js" defer></script>
    <script>
      // --- State ---
      let userList = ["apple", "banana"]; // Initial list for the operations section
      const indexingExampleList = ["apple", "banana", "cherry", "date"]; // Fixed list for indexing example
      let iterationList = []; // List used for the iteration example
      let currentIterationIndex = -1; // -1 means not started
      let iterationInterval = null; // To control the step-by-step iteration animation

      // --- DOM Elements ---
      const itemInput = document.getElementById("itemInput");
      const addButton = document.getElementById("addButton");
      const removeButton = document.getElementById("removeButton");
      const clearButton = document.getElementById("clearButton");
      const listVisualizer = document.getElementById("listVisualizer");
      const listMessage = document.getElementById("listMessage");

      const indexingListVisualizer = document.getElementById(
        "indexingListVisualizer"
      );
      const indexInput = document.getElementById("indexInput");
      const accessIndexButton = document.getElementById("accessIndexButton");
      const indexingResultDisplay = document.getElementById(
        "indexingResultDisplay"
      );
      const indexingMessage = document.getElementById("indexingMessage");

      const iterateButton = document.getElementById("iterateButton");
      const resetIterationButton = document.getElementById(
        "resetIterationButton"
      );
      const iterationListVisualizer = document.getElementById(
        "iterationListVisualizer"
      );
      const iterationOutput = document.getElementById("iterationOutput");
      const iterationMessage = document.getElementById("iterationMessage");

      const checkQuizButton = document.getElementById("checkQuizButton");
      const quizResult = document.getElementById("quizResult");

      // --- Utility Functions ---
      function renderListVisual(list, containerElement, showIndices = false) {
        containerElement.innerHTML = ""; // Clear previous items
        if (list.length === 0) {
          containerElement.innerHTML =
            '<span class="text-gray-500 italic">List is empty.</span>';
          return;
        }
        list.forEach((item, index) => {
          const span = document.createElement("span");
          span.textContent = item;
          span.className = "list-item-vis";
          span.dataset.index = index; // Store index for potential highlighting

          if (showIndices) {
            const indexLabel = document.createElement("span");
            indexLabel.className = "index-label";
            indexLabel.textContent = index;
            span.appendChild(indexLabel);

            // Add negative index label too
            const negIndexLabel = document.createElement("span");
            negIndexLabel.className = "index-label";
            negIndexLabel.style.bottom = "-2.4em"; // Position below positive index
            negIndexLabel.textContent = `(${index - list.length})`; // Calculate negative index
            span.appendChild(negIndexLabel);
          }
          containerElement.appendChild(span);
        });
        // Adjust container padding if indices are shown
        if (showIndices) {
          containerElement.style.paddingBottom = "2.5em"; // Make space for negative indices
        } else {
          containerElement.style.paddingBottom = ""; // Reset padding
        }
      }

      // --- Clear Highlights (Generic) ---
      function clearHighlights(containerElement) {
        containerElement
          .querySelectorAll(".list-item-vis.highlight")
          .forEach((el) => {
            el.classList.remove("highlight");
          });
      }

      // --- Indexing Logic ---
      function handleAccessIndex() {
        clearHighlights(indexingListVisualizer); // Clear previous highlight
        const indexStr = indexInput.value;
        if (indexStr === "") {
          showMessage(indexingMessage, "Please enter an index.", "error");
          indexingResultDisplay.textContent =
            "<span class=\"text-gray-500 italic\">Enter an index and click 'Access Element'.</span>";
          return;
        }

        const index = parseInt(indexStr, 10);
        const listLength = indexingExampleList.length;

        // Validate index
        if (isNaN(index) || index < -listLength || index >= listLength) {
          showMessage(
            indexingMessage,
            `Index out of bounds. Valid range: -${listLength} to ${
              listLength - 1
            }.`,
            "error"
          );
          indexingResultDisplay.textContent =
            '<span class="text-red-500">Error: Index out of bounds.</span>';
          return;
        }

        // Calculate the actual positive index if negative is used
        const actualIndex = index < 0 ? listLength + index : index;
        const element = indexingExampleList[actualIndex];

        // Display result
        indexingResultDisplay.textContent = `Element at index ${index} (actual index ${actualIndex}): "${element}"`;

        // Highlight the accessed element
        const targetElement = indexingListVisualizer.querySelector(
          `.list-item-vis[data-index="${actualIndex}"]`
        );
        if (targetElement) {
          targetElement.classList.add("highlight");
        }
        showMessage(
          indexingMessage,
          "Element accessed successfully.",
          "success"
        );
      }

      // --- List Operations Logic ---
      function handleAddItem() {
        const newItem = itemInput.value.trim();
        if (newItem) {
          userList.push(newItem);
          renderListVisual(userList, listVisualizer);
          itemInput.value = ""; // Clear input
          showMessage(
            listMessage,
            `"${newItem}" added to the list.`,
            "success"
          );
        } else {
          showMessage(listMessage, "Please enter an item to add.", "error");
        }
        itemInput.focus(); // Keep focus on input
      }

      function handleRemoveItem() {
        if (userList.length > 0) {
          const removedItem = userList.pop(); // Removes and returns the last item
          renderListVisual(userList, listVisualizer);
          showMessage(
            listMessage,
            `Removed "${removedItem}" from the end.`,
            "success"
          );
        } else {
          showMessage(listMessage, "The list is already empty.", "error");
        }
      }

      function handleClearList() {
        if (userList.length > 0) {
          userList = [];
          renderListVisual(userList, listVisualizer);
          showMessage(listMessage, "List cleared.", "success");
        } else {
          showMessage(listMessage, "The list is already empty.", "error");
        }
      }

      // --- Iteration Logic ---
      function prepareIteration() {
        // Stop any ongoing iteration animation
        if (iterationInterval) {
          clearInterval(iterationInterval);
          iterationInterval = null;
        }
        // Use the user's list if not empty, otherwise use a default
        iterationList =
          userList.length > 0 ? [...userList] : ["item1", "item2", "item3"];
        renderListVisual(iterationList, iterationListVisualizer); // Use generic render
        iterationOutput.innerHTML =
          '<span class="text-gray-500 italic">Click "Iterate Through List" to start.</span>';
        currentIterationIndex = -1; // Reset index
        iterateButton.disabled = false;
        showMessage(iterationMessage, "List ready for iteration.", "success");
      }

      function resetIterationVisuals() {
        // Remove highlights from iteration list visualizer
        clearHighlights(iterationListVisualizer);
        iterationOutput.innerHTML =
          '<span class="text-gray-500 italic">Iteration reset. Click "Iterate Through List" to start again.</span>';
        if (iterationInterval) {
          clearInterval(iterationInterval);
          iterationInterval = null;
        }
        currentIterationIndex = -1;
        iterateButton.disabled = false;
      }

      function stepThroughIteration() {
        // Remove highlight from previous item
        if (currentIterationIndex >= 0) {
          const prevElement = iterationListVisualizer.querySelector(
            `.list-item-vis[data-index="${currentIterationIndex}"]`
          );
          if (prevElement) prevElement.classList.remove("highlight");
        }

        currentIterationIndex++;

        if (currentIterationIndex < iterationList.length) {
          const currentItem = iterationList[currentIterationIndex];
          const currentElement = iterationListVisualizer.querySelector(
            `.list-item-vis[data-index="${currentIterationIndex}"]`
          );

          // Highlight current item
          if (currentElement) currentElement.classList.add("highlight");

          // Update output
          iterationOutput.innerHTML = `Processing item at index ${currentIterationIndex}: <strong class="text-blue-600">${currentItem}</strong>`;
        } else {
          // Iteration finished
          iterationOutput.innerHTML = `<strong class="text-green-600">Iteration Complete!</strong> Processed all ${iterationList.length} items.`;
          clearInterval(iterationInterval);
          iterationInterval = null;
          iterateButton.disabled = false; // Re-enable button
          showMessage(iterationMessage, "Iteration finished.", "success");
        }
      }

      function startIteration() {
        // Prepare the list first (copies user list or uses default)
        prepareIteration();

        if (iterationList.length === 0) {
          showMessage(
            iterationMessage,
            "The list is empty, nothing to iterate.",
            "error"
          );
          return;
        }

        // Disable button during iteration
        iterateButton.disabled = true;
        resetIterationVisuals(); // Clear previous state before starting
        currentIterationIndex = -1; // Ensure starting from the beginning
        iterationOutput.innerHTML = "Starting iteration...";

        // Start step-by-step process with a delay
        iterationInterval = setInterval(stepThroughIteration, 1000); // 1 second delay between steps
      }

      // --- Quiz Logic ---
      function checkQuiz() {
        const answers = {
          q1: "b", // 0
          q2: "c", // 40 (-1 is last)
          q3: "c", // for
        };
        let score = 0;
        let resultsHTML = "<ul>";
        let allAnswered = true;

        for (const q in answers) {
          const selected = document.querySelector(`input[name="${q}"]:checked`);
          if (!selected) {
            allAnswered = false;
            break; // Stop checking if one question is unanswered
          }
          const isCorrect = selected.value === answers[q];
          if (isCorrect) {
            score++;
            resultsHTML += `<li class="text-green-700">✓ Question ${q.substring(
              1
            )}: Correct!</li>`;
          } else {
            resultsHTML += `<li class="text-red-700">✗ Question ${q.substring(
              1
            )}: Incorrect.</li>`;
          }
        }

        if (!allAnswered) {
          quizResult.textContent =
            "Please answer all questions before checking.";
          quizResult.className = "message-box message-box-error";
          quizResult.style.display = "block";
          return;
        }

        resultsHTML += "</ul>";
        resultsHTML =
          `<p class="font-medium mb-2">You scored ${score} out of ${
            Object.keys(answers).length
          }.</p>` + resultsHTML;

        quizResult.innerHTML = resultsHTML;
        quizResult.className =
          score === Object.keys(answers).length
            ? "message-box message-box-success"
            : "message-box message-box-error";
        quizResult.style.display = "block";
      }

      // --- Event Listeners ---
      addButton.addEventListener("click", handleAddItem);
      itemInput.addEventListener("keypress", (event) => {
        if (event.key === "Enter") handleAddItem();
      });
      removeButton.addEventListener("click", handleRemoveItem);
      clearButton.addEventListener("click", handleClearList);

      accessIndexButton.addEventListener("click", handleAccessIndex);
      indexInput.addEventListener("keypress", (event) => {
        if (event.key === "Enter") handleAccessIndex();
      });

      iterateButton.addEventListener("click", startIteration);
      resetIterationButton.addEventListener("click", () => {
        resetIterationVisuals();
        prepareIteration(); // Re-prepare the list visualizer
        showMessage(iterationMessage, "Iteration reset.", "success");
      });

      checkQuizButton.addEventListener("click", checkQuiz);

      // --- Initial Setup ---
      renderListVisual(userList, listVisualizer);
      renderListVisual(indexingExampleList, indexingListVisualizer, true);
      prepareIteration(); // Set up the iteration visualizer with a default or user list
    </script>
  </body>
</html>
